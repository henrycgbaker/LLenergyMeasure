---
phase: 04-codebase-audit
plan: 06
type: execute
wave: 2
depends_on: ["04-01", "04-02", "04-03", "04-04", "04-05"]
files_modified:
  - .planning/phases/04-codebase-audit/AUDIT-REPORT.md
autonomous: false

must_haves:
  truths:
    - "Single comprehensive audit report assembled from all section reports"
    - "Executive summary highlights top findings by severity"
    - "Phase 5 action skeleton provides grouped, prioritised tasks ready for planning"
    - "Module checklist confirms every src/ directory was audited (no blind spots)"
    - "Report presented to user for section-by-section review"
  artifacts:
    - path: ".planning/phases/04-codebase-audit/AUDIT-REPORT.md"
      provides: "Complete codebase audit report with findings, recommendations, and Phase 5 skeleton"
  key_links:
    - from: ".planning/phases/04-codebase-audit/AUDIT-REPORT.md"
      to: ".planning/ROADMAP.md Phase 5"
      via: "Phase 5 skeleton section provides input for Phase 5 planning"
      pattern: "Phase 5.*skeleton"
---

<objective>
Assemble all audit section reports into a single comprehensive audit report, produce an executive summary, create a Phase 5 action skeleton, and present findings to the user for review.

Purpose: The audit report is the primary deliverable of Phase 4. It drives Phase 5 (Refactor & Simplify). The report must be comprehensive enough that Phase 5 planning can proceed without re-auditing.

Output: Complete AUDIT-REPORT.md with executive summary, all section findings, module checklist, and Phase 5 action skeleton.
</objective>

<execution_context>
@/home/h.baker@hertie-school.lan/.claude/agents/gsd-planner.md
</execution_context>

<context>
@.planning/phases/04-codebase-audit/04-CONTEXT.md
@.planning/phases/04-codebase-audit/04-01-SUMMARY.md
@.planning/phases/04-codebase-audit/04-02-SUMMARY.md
@.planning/phases/04-codebase-audit/04-03-SUMMARY.md
@.planning/phases/04-codebase-audit/04-04-SUMMARY.md
@.planning/phases/04-codebase-audit/04-05-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Assemble comprehensive audit report</name>
  <files>.planning/phases/04-codebase-audit/AUDIT-REPORT.md</files>
  <action>
Read all five section reports and assemble into a single comprehensive audit report:
- .planning/phases/04-codebase-audit/04-01-REPORT-automated-analysis.md
- .planning/phases/04-codebase-audit/04-02-REPORT-cli-config.md
- .planning/phases/04-codebase-audit/04-03-REPORT-core-engine.md
- .planning/phases/04-codebase-audit/04-04-REPORT-orchestration-results.md
- .planning/phases/04-codebase-audit/04-05-REPORT-infra-tests-xref.md

**Report structure:**

```markdown
# Codebase Audit Report — LLenergyMeasure v2.0.0

## Executive Summary
- Total findings by severity: X remove, Y simplify, Z keep
- Top 5 highest-impact findings
- Total codebase size: N lines across M files
- Estimated complexity reduction potential

## 1. Automated Analysis Results
[From 04-01 report]

## 2. CLI Surface Audit
[From 04-02 report — CLI section]

## 3. Configuration System Audit
[From 04-02 report — config section]

## 4. Core Engine Audit
[From 04-03 report]
### 4.1 Backend Completeness Assessment
### 4.2 Backend-Native Pattern Comparison
(vLLM vs benchmark_serving.py, TensorRT vs trtllm-bench, PyTorch vs HuggingFace patterns)
### 4.3 Docker Execution Path Assessment (all 3 backends currently broken)

## 5. Orchestration & Campaign Audit
[From 04-04 report — orchestration/campaign section]

## 6. Results, State & Domain Audit
[From 04-04 report — results/state/domain section]

## 7. Infrastructure & Docker Audit
[From 04-05 report — Docker/detection section]

## 8. Test Quality Audit
[From 04-05 report — test section]

## 9. Planning Cross-Reference
[From 04-05 report — cross-reference section]

## 10. Documentation Staleness
[From 04-05 report — docs section]

## Module Checklist
Every src/ directory explicitly checked off:
- [ ] cli/
- [ ] config/
- [ ] core/
- [ ] core/inference_backends/
- [ ] core/energy_backends/
- [ ] domain/
- [ ] orchestration/
- [ ] results/
- [ ] state/
- [ ] notifications/
- [ ] Top-level modules

## Phase 5 Action Skeleton
Grouped, prioritised tasks for Phase 5 planner:

### Priority 1: Remove (dead code, unused modules)
- [specific items to remove, grouped by module]

### Priority 2: Simplify (over-engineered patterns)
- [specific simplification targets, grouped by concern]

### Priority 3: Wire Up (unwired features)
- [specific unwired features to connect or remove]

### Priority 4: Fix (incorrect behavior)
- [specific corrections needed]

### Priority 5: Refresh (stale documentation)
- [docs to update]
```

**Quality criteria for the report:**
- Every finding must have a severity (remove/simplify/keep)
- Every recommendation must have industry comparison evidence ("industry does X, we do Y")
- Module checklist must have every src/ subdirectory checked
- Phase 5 skeleton must be specific enough for Phase 5 planner to work from
- No vague findings ("seems complex") — only evidence-based assessments
  </action>
  <verify>
AUDIT-REPORT.md exists, contains all 10 sections plus executive summary, module checklist is complete, Phase 5 skeleton has specific items grouped by priority.
  </verify>
  <done>Comprehensive audit report assembled with executive summary, all findings, module checklist, and Phase 5 action skeleton.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete codebase audit report covering all modules, with industry comparison evidence, severity classifications, and Phase 5 action skeleton.</what-built>
  <how-to-verify>
    1. Read the AUDIT-REPORT.md at .planning/phases/04-codebase-audit/AUDIT-REPORT.md
    2. Review executive summary — do the top findings match your intuition?
    3. Check module checklist — is everything covered?
    4. Review Phase 5 skeleton — are the priorities correct?
    5. Flag any findings you disagree with or want to adjust
    6. Confirm the report is ready to drive Phase 5 planning
  </how-to-verify>
  <resume-signal>Type "approved" to confirm audit findings, or describe adjustments needed.</resume-signal>
</task>

</tasks>

<verification>
- AUDIT-REPORT.md exists and is comprehensive
- Executive summary present with severity counts
- All 10 sections populated
- Module checklist complete (all src/ directories checked)
- Phase 5 skeleton has grouped, prioritised items
- User has reviewed and approved findings
</verification>

<success_criteria>
- Single comprehensive audit report ready
- User has reviewed and approved the report
- Phase 5 skeleton provides clear input for Phase 5 planning
- No blind spots in module coverage
</success_criteria>

<output>
After completion, create `.planning/phases/04-codebase-audit/04-06-SUMMARY.md`
</output>
